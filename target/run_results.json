{"metadata": {"dbt_schema_version": "https://schemas.getdbt.com/dbt/run-results/v6.json", "dbt_version": "1.8.4", "generated_at": "2024-08-01T08:38:46.771387Z", "invocation_id": "b4f06c36-49e8-4d5b-b4d3-aa05aab56cf2", "env": {}}, "results": [{"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-01T08:38:20.993140Z", "completed_at": "2024-08-01T08:38:21.006668Z"}, {"name": "execute", "started_at": "2024-08-01T08:38:21.007660Z", "completed_at": "2024-08-01T08:38:22.532480Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 1.8763103485107422, "adapter_response": {"_message": "SUCCESS 1", "code": "SUCCESS", "rows_affected": 1, "query_id": "01b60e06-0206-d240-0007-6bf30004920e"}, "message": "SUCCESS 1", "failures": null, "unique_id": "model.learndbt.dim_hosts_cleansed", "compiled": true, "compiled_code": "\nWITH  __dbt__cte__src_hosts as (\nWITH raw_hosts AS (\r\n SELECT\r\n *\r\n FROM\r\n AIRBNB.RAW.RAW_HOSTS\r\n)\r\nSELECT \r\n    ID AS host_id\r\n    , NAME AS host_name \r\n    , IS_SUPERHOST\r\n    , CREATED_AT\r\n    , UPDATED_AT\r\n\r\nFROM raw_hosts\n), src_hosts AS (\n    SELECT * FROM __dbt__cte__src_hosts\n)\nSELECT \n   HOST_ID\n   , NVL(HOST_NAME, 'ANONYMOUS') AS HOST_NAME\n   , IS_SUPERHOST\n   , CREATED_AT\n   , UPDATED_AT\nFROM src_hosts", "relation_name": "AIRBNB.DEV.dim_hosts_cleansed"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-01T08:38:22.878956Z", "completed_at": "2024-08-01T08:38:22.897295Z"}, {"name": "execute", "started_at": "2024-08-01T08:38:22.898300Z", "completed_at": "2024-08-01T08:38:24.984561Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 2.504274845123291, "adapter_response": {"_message": "SUCCESS 1", "code": "SUCCESS", "rows_affected": 1, "query_id": "01b60e06-0206-d23c-0007-6bf30004328e"}, "message": "SUCCESS 1", "failures": null, "unique_id": "model.learndbt.dim_listings_cleansed", "compiled": true, "compiled_code": "\nWITH  __dbt__cte__src_listings as (\nWITH raw_listings AS (\r\n    SELECT\r\n    *\r\n    FROM\r\n    AIRBNB.RAW.RAW_LISTINGS\r\n)\r\nSELECT\r\n    id AS listing_id,\r\n    name AS listing_name,\r\n    listing_url,\r\n    room_type,\r\n    minimum_nights,\r\n    host_id,\r\n    price AS price_str,\r\n    created_at,\r\n    updated_at\r\nFROM\r\n    raw_listings\n), src_listings AS (\n    SELECT * FROM __dbt__cte__src_listings\n)\nSELECT \n    listing_id,\n    listing_name,\n    room_type,\n    CASE\n        WHEN minimum_nights = 0 THEN 1\n        ELSE minimum_nights\n    END AS minimum_nights,\n    host_id,\n    REPLACE(price_str, '$', '') :: NUMBER(10,2) AS price,\n    created_at,\n    updated_at\nFROM src_listings", "relation_name": "AIRBNB.DEV.dim_listings_cleansed"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-01T08:38:25.391794Z", "completed_at": "2024-08-01T08:38:25.414511Z"}, {"name": "execute", "started_at": "2024-08-01T08:38:25.415516Z", "completed_at": "2024-08-01T08:38:32.326500Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 7.365419149398804, "adapter_response": {"_message": "SUCCESS 0", "code": "SUCCESS", "rows_affected": 0, "query_id": "01b60e06-0206-d23b-0007-6bf300046232"}, "message": "SUCCESS 0", "failures": null, "unique_id": "model.learndbt.fct_reviews", "compiled": true, "compiled_code": "\n\nWITH  __dbt__cte__src_reviews as (\nWITH raw_reviews AS (\r\n SELECT\r\n *\r\n FROM\r\n AIRBNB.RAW.RAW_REVIEWS\r\n)\r\nSELECT \r\n    LISTING_ID\r\n    , DATE AS REVIEW_DATE\r\n    , REVIEWER_NAME\r\n    , COMMENTS AS REVIEW_TEXT\r\n    , SENTIMENT AS REVIEW_SENTIMENT\r\n\r\nFROM raw_reviews\n), src_reviews AS (\n SELECT * FROM __dbt__cte__src_reviews\n)\nSELECT * FROM src_reviews\nWHERE REVIEW_TEXT is not null\n\n AND review_date > (select max(review_date) from AIRBNB.DEV.fct_reviews)\n", "relation_name": "AIRBNB.DEV.fct_reviews"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-01T08:38:32.764200Z", "completed_at": "2024-08-01T08:38:32.772771Z"}, {"name": "execute", "started_at": "2024-08-01T08:38:32.774775Z", "completed_at": "2024-08-01T08:38:35.992683Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 3.619166135787964, "adapter_response": {"_message": "SUCCESS 1", "code": "SUCCESS", "rows_affected": 1, "query_id": "01b60e06-0206-d23f-0007-6bf30004bc46"}, "message": "SUCCESS 1", "failures": null, "unique_id": "model.learndbt.dim_listings_w_hosts", "compiled": true, "compiled_code": "WITH\n    l AS (\n    SELECT * FROM AIRBNB.DEV.dim_listings_cleansed\n),\nh AS ( SELECT * FROM AIRBNB.DEV.dim_hosts_cleansed\n)\nSELECT\n    l.listing_id,\n    l.listing_name,\n    l.room_type,\n    l.minimum_nights,\n    l.price,\n    l.host_id,\n    h.host_name,\n    h.is_superhost as host_is_superhost,\n    l.created_at,\n    GREATEST(l.updated_at, h.updated_at) as updated_at\nFROM l\nLEFT JOIN h ON (h.host_id = l.host_id)", "relation_name": "AIRBNB.DEV.dim_listings_w_hosts"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-08-01T08:38:36.390413Z", "completed_at": "2024-08-01T08:38:36.401294Z"}, {"name": "execute", "started_at": "2024-08-01T08:38:36.403377Z", "completed_at": "2024-08-01T08:38:46.160021Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 10.370865821838379, "adapter_response": {"_message": "SUCCESS 1", "code": "SUCCESS", "rows_affected": 1, "query_id": "01b60e06-0206-d237-0007-6bf30004a2ca"}, "message": "SUCCESS 1", "failures": null, "unique_id": "model.learndbt.fullmoon_reviews", "compiled": true, "compiled_code": "\nWITH fct_reviews AS (\n    SELECT * FROM AIRBNB.DEV.fct_reviews\n),\n    full_moon_dates AS (\n    SELECT * FROM AIRBNB.DEV.seed_full_moon_dates\n)\n    SELECT\n    r.*,\n    CASE\n    WHEN fm.full_moon_date IS NULL THEN 'not full moon'\n    ELSE 'full moon'\n    END AS is_full_moon\n    FROM\n    fct_reviews\n    r\n    LEFT JOIN full_moon_dates\n    fm\n    ON (TO_DATE(r.review_date) = DATEADD(DAY, 1, fm.full_moon_date))", "relation_name": "AIRBNB.DEV.fullmoon_reviews"}], "elapsed_time": 32.60850477218628, "args": {"empty": false, "log_level_file": "debug", "log_level": "info", "log_format": "default", "source_freshness_run_project_hooks": false, "vars": {}, "which": "run", "version_check": true, "favor_state": false, "printer_width": 80, "partial_parse": true, "populate_cache": true, "profiles_dir": "C:\\Users\\jezan\\.dbt", "enable_legacy_logger": false, "log_file_max_bytes": 10485760, "exclude": [], "select": [], "show_resource_report": false, "project_dir": "L:\\DBT Course", "indirect_selection": "eager", "static_parser": true, "quiet": false, "strict_mode": false, "introspect": true, "require_explicit_package_overrides_for_builtin_materializations": true, "use_colors": true, "invocation_command": "dbt run", "use_colors_file": true, "macro_debugging": false, "log_path": "L:\\DBT Course\\logs", "partial_parse_file_diff": true, "require_resource_names_without_spaces": false, "warn_error_options": {"include": [], "exclude": []}, "write_json": true, "cache_selected_only": false, "log_format_file": "debug", "print": true, "send_anonymous_usage_stats": true, "defer": false}}